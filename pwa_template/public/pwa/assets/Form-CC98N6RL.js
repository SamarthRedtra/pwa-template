var b=(u,e,m)=>new Promise((n,o)=>{var c=i=>{try{v(m.next(i))}catch(s){o(s)}},w=i=>{try{v(m.throw(i))}catch(s){o(s)}},v=i=>i.done?n(i.value):Promise.resolve(i.value).then(c,w);v((m=m.apply(u,e)).next())});import{_ as F,a as z,b as G,c as J,d as K,e as Q,f as W,g as X,h as Y,i as B,j as Z,L as ee,k as te,l as ae,C as se,u as le}from"./SectionBreak-ig4Jyi9K.js";import{U as re,D as ne}from"./User-BBOFE-lM.js";import{m as oe,r as f,y as ie,h as g,z as T,k as ce,o as r,a as x,b as a,d as _,u as l,_ as d,t as S,A as k,F as ue,p as me,B as h,C as fe,l as C,f as L,j as N,w as j,v as de,x as ve,n as pe,E as _e}from"./index-D6WzF6ad.js";import"./TextInput.vue_vue_type_script_setup_true_lang-TNnHxwuu.js";import"./Popover-3KP7P3bG.js";import"./FormControl.vue_vue_type_script_setup_true_lang-C4lNgMaF.js";import"./Avatar.vue_vue_type_script_setup_true_lang-CIzqSjko.js";const he=u=>(de("data-v-2ef6dc61"),u=u(),ve(),u),be={class:"w-full sm:w-96 bg-white flex justify-center h-screen"},ge={class:"w-full flex flex-col"},xe={class:"w-full sm:w-96 bg-white h-14 shadow-lg fixed top-0 z-10"},ye={class:"p-2 flex pt-3"},we=he(()=>a("div",null,null,-1)),Se={class:"font-semibold w-fit text-xl pt-[8px] pr-2"},ke={class:"w-full flex justify-end"},Ce={class:"p-1 pr-4"},$e={class:"flex-1 overflow-y-auto custom-scrollbar pt-20 pb-14 p-2 bg-gray-200"},Te={class:"p-2 bg-white rounded-lg"},De={class:"flex w-full sm:w-96 pb-1 pt-1 fixed bottom-0 z-10 bg-white shadow-lg justify-center"},Fe={class:"pt-1 w-[20rem] sm:w-[20rem] ml-3"},ze={key:4,class:"fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96 animate-slide-in"},Be={class:"rounded w-[20rem] h-fit p-2 text-left bg-blue-200 text-blue-500"},Le={class:"p-2 pr-2 pt-[5px]"},Ne={__name:"form_builder",props:{frm:Object,doctype:String,frnname:String},setup(u){const e=u,m={Data:F,Select:z,Int:G,Autocomplete:J,Dynamic_Link:z,Heading:K,Datetime:Q,Date:W,"Section Break":X,Check:Y,Text:F,"Long Text":B,"Small Text":B,Float:Z,Link:ee,Currency:te,Attach:ae,Table:se},n=f(!1),o=f(""),c=f(!1),w=f(0),v=f(!1),i=f(""),s=f(0),A=f({});e.frm.doctype=e.doctype,e.frm.Frm=e.frnname,ie(s,t=>{t===1&&(v.value=!1)});const E=()=>b(this,null,function*(){n.value=!0,w.value=e.frm.submitable;try{const t=yield e.frm.save();i.value=t,o.value="Save successful!",c.value=!0,w.value===1&&(v.value=!0),A.value=e.frm.doc,D.push({path:"/showform",query:{docname:t,frmname:e.frm.Frm,doctype:e.frm.doctype}})}catch(t){o.value=`Error: ${t.message}`,c.value=!1,console.error(`Error: ${t.message}`)}finally{n.value=!1,setTimeout(()=>{o.value=""},2500)}}),I=()=>b(this,null,function*(){n.value=!0;try{s.value=yield e.frm.submit(i.value),o.value="Submit successful!",c.value=!0}catch(t){o.value=`Error: ${t.message}`,c.value=!1,console.error(`Error: ${t.message}`)}finally{n.value=!1,setTimeout(()=>{o.value=""},2500)}}),q=()=>b(this,null,function*(){console.log(s.value)}),V=g(()=>{const t=[];let $=0;for(const p of e.frm.fields)p.fieldtype==="Section Break"?($+=1,t.push(p)):$===0&&t.push(p);return t}),M=g(()=>{if(e.frm.Saved===0)return"Not Saved";if(e.frm.Saved===1)return e.frm.submitable===1&&s.value!==1?"Draft":s.value===1?"Submitted":"Saved"}),R=g(()=>{if(e.frm.Saved===0)return"bg-red-200 h-[2rem] rounded-2xl text-center";if(e.frm.Saved===1)return e.frm.submitable===1&&s.value!==1?"bg-red-200 h-[2rem] rounded-2xl text-center":(s.value===1,"bg-green-200 h-[2rem] rounded-2xl text-center")}),O=g(()=>{if(e.frm.Saved===0)return"p-2 text-sm w-20 text-red-500";if(e.frm.Saved===1)return e.frm.submitable===1&&s.value!==1?"p-2 text-sm w-20 text-red-500":(s.value===1,"p-2 text-sm w-20 text-green-500")}),y=f(""),P=()=>b(this,null,function*(){i.value&&(y.value=yield e.frm.delete(i.value),console.log(y.value),setTimeout(()=>{y.value=""},2500))}),U=g(()=>{const t=[{label:"Print",icon:()=>T(d,{name:"printer"})},{label:"Create New "+e.frm.doctype,icon:()=>T(d,{name:"file-plus"})}];return!v.value&&s.value!==1&&t.push({label:"Delete",icon:()=>T(d,{name:"trash"}),onClick:P}),[{group:"Actions",items:t}]}),D=ce(),H=()=>{e.frm.doc={docstatus:0},e.frm.name=null,e.frm.fields=[],e.frm.Docstatus=0,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0,D.push({name:"ListPage",query:{frmname:e.frm.Frm,doctype:e.frm.doctype}})};return(t,$)=>(r(),x("div",be,[a("div",ge,[a("div",xe,[a("div",ye,[we,_(l(d),{class:"w-8 h-8 text-gray-600 hover:text-black",name:"chevron-left",onClick:H}),a("p",Se,S(u.frm.doctype),1),a("div",{class:k(R.value)},[a("p",{class:k(O.value)},S(M.value),3)],2),a("div",ke,[a("div",Ce,[_(l(d),{class:"w-6 h-6 text-gray-600 hover:text-black",name:"bell"})]),_(re)])])]),a("div",$e,[a("div",Te,[(r(!0),x(ue,null,me(V.value,p=>(r(),h(fe(m[p.fieldtype]),{key:p.fieldname,field:p,frm:u.frm},null,8,["field","frm"]))),128))])]),a("div",De,[a("div",Fe,[e.frm.Saved==0?(r(),h(l(C),{key:0,variant:"solid",theme:"gray",size:"sm",label:"Save",loading:n.value,loadingText:"Saving...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:E},null,8,["loading"])):s.value===1&&!v.value?(r(),h(l(C),{key:1,variant:"outline",theme:"gray",size:"sm",label:"Cancel",loading:n.value,loadingText:"Cancelling...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:q},null,8,["loading"])):(r(),h(l(C),{key:2,variant:"solid",theme:"gray",size:"sm",label:"Submit",loading:n.value,loadingText:"Submitting...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:I},null,8,["loading"])),o.value?(r(),x("div",{key:3,class:k(["fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96",c.value?"animate-slide-in":"animate-slide-out"])},[a("div",{class:k(["rounded w-[20rem] h-fit p-2 text-left",{"bg-blue-200 text-blue-500":c.value,"bg-red-200 text-red-500":!c.value}])},[c.value?(r(),h(l(d),{key:0,name:"check",class:"inline w-4 h-4 mr-2"})):(r(),h(l(d),{key:1,name:"x",class:"inline w-4 h-4 mr-2"})),L(" "+S(o.value),1)],2)],2)):N("",!0),y.value?(r(),x("div",ze,[a("div",Be,[_(l(d),{name:"info",class:"inline w-4 h-4 mr-2"}),L(" "+S(y.value),1)])])):N("",!0)]),a("div",Le,[_(l(ne),{options:U.value},{default:j(()=>[_(l(C),null,{icon:j(()=>[_(l(d),{name:"more-vertical",class:"h-6 w-6 text-gray-600 hover:text-black"})]),_:1})]),_:1},8,["options"])])])])]))}},je=oe(Ne,[["__scopeId","data-v-2ef6dc61"]]),Ae={class:"w-full flex-1 overflow-y-auto custom-scrollbar"},Ee={key:1},He={__name:"Form",setup(u){const e=le(),m=g(()=>e.form),n=_e();return pe(()=>b(this,null,function*(){yield e.initForm()})),(o,c)=>(r(),x("div",Ae,[m.value?(r(),h(je,{key:0,frm:m.value,frnname:l(n).query.frmname,doctype:l(n).query.doctype},null,8,["frm","frnname","doctype"])):(r(),x("p",Ee,"Loading..."))]))}};export{He as default};
