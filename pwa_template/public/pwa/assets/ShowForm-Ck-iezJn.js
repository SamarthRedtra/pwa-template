var w=(p,e,x)=>new Promise((r,o)=>{var m=d=>{try{f(x.next(d))}catch($){o($)}},V=d=>{try{f(x.throw(d))}catch($){o($)}},f=d=>d.done?r(d.value):Promise.resolve(d.value).then(m,V);f((x=x.apply(p,e)).next())});import{_ as R,a as P,b as ce,c as fe,d as de,e as ve,f as be,g as pe,h as xe,i as M,j as he,L as ge,k as ye,l as _e,C as we,u as ke}from"./SectionBreak-ig4Jyi9K.js";import{m as Se,r as n,y as Ce,h as y,z as I,k as De,o as s,a as u,b as l,d as c,u as a,_ as b,A as h,t as g,j as C,F as $e,p as Te,B as _,C as Ae,w as N,T as ze,D as q,l as D,f as F,v as Ve,x as Ee,n as Ie,E as je}from"./index-D6WzF6ad.js";import{U as Be,D as Le}from"./User-BBOFE-lM.js";import"./TextInput.vue_vue_type_script_setup_true_lang-TNnHxwuu.js";import"./Popover-3KP7P3bG.js";import"./FormControl.vue_vue_type_script_setup_true_lang-C4lNgMaF.js";import"./Avatar.vue_vue_type_script_setup_true_lang-CIzqSjko.js";const Ne=p=>(Ve("data-v-36e0a400"),p=p(),Ee(),p),qe={class:"w-full sm:w-96 bg-white flex justify-center h-screen"},Fe={class:"w-full flex flex-col"},Ue={class:"w-full sm:w-96 bg-white h-16 shadow-lg fixed top-0 z-10"},Re={class:"pr-2 flex pt-3 items-center"},Pe={class:"font-semibold w-fit text-xl pr-2"},Me={key:0,class:"pt-1 b-2 text-xs font-light text-gray-600"},He={key:0},Oe={key:1},We={class:"w-full flex justify-end"},Ge={class:"p-1 pr-4"},Je={class:"flex-1 overflow-y-auto custom-scrollbar pt-20 pb-14 p-2 bg-gray-100"},Ke={class:"bg-white rounded-lg"},Qe={key:0,class:"w-full sm:w-96 fixed bottom-0 left-0 h-[15%] bg-white border-t border-gray-300 shadow-lg z-[1000] flex flex-col touch-area rounded-t-md"},Xe={class:"text-gray-600 p-2 text-[15px]"},Ye=Ne(()=>l("div",{class:"w-full border-b-[0.5px] border-gray-300 flex text-center justify-center touchable hover:cursor-pointer"},[l("p",{class:"text-gray-600 p-2 text-[15px]"},"Help")],-1)),Ze={class:"flex w-full sm:w-96 pl-3 pb-1 pt-1 fixed bottom-0 z-10 bg-white justify-center shadow-lg"},et={class:"pt-1 w-[20rem] sm:w-[20rem] ml-3"},tt={key:0},lt={key:1},st={key:3,class:"fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96 animate-slide-in"},at={class:"rounded w-[20rem] h-fit p-2 text-left bg-blue-200 text-blue-500"},rt={class:"rounded w-[20rem] h-fit p-2 text-left bg-red-200 text-red-500"},nt={class:"p-2 pr-2 pt-[5px]"},ot={__name:"show_form_builder",props:{frm:Object,docname:String,frmname:String,doctype:String},setup(p){const e=p,x={Data:R,Select:P,Int:ce,Autocomplete:fe,Dynamic_Link:P,Heading:de,Datetime:ve,Date:be,"Section Break":pe,Check:xe,Text:R,"Long Text":M,"Small Text":M,Float:he,Link:ge,Currency:ye,Attach:_e,Table:we},r=n(!1),o=n(""),m=n(!1),V=n(e.frm.submitable),f=n(e.docname),d=n(e.frm.Docstatus),$=n({}),H=n(e.frm.Saved),O=n(e.frm.Submit),k=n(!1),T=n(!1),A=n(!1),W=n(e.frm.Amend),z=n(""),j=n(""),S=n(!1),B=n(!1),G=()=>{S.value=!S.value};Ce(e.frm,t=>{d.value=t.Docstatus,H.value=t.Saved,O.value=t.Submit,V.value=t.submitable,W.value=t.Amend,t.action?B.value=!1:B.value=!0});const J=()=>{e.frm.workflow(),S.value=!1};e.frm.name=e.docname,e.frm.doctype=e.doctype,e.frm.Frm=e.frmname;const K=()=>w(this,null,function*(){r.value=!0,V.value=e.frm.submitable;try{yield e.frm.update(),o.value="Updated successful!",m.value=!0,$.value=e.frm.doc,e.frm.workflow}catch(t){o.value=`Error: ${t.message}`,m.value=!1,console.error(`Error: ${t.message}`)}finally{r.value=!1,setTimeout(()=>{o.value=""},2500)}}),Q=()=>w(this,null,function*(){r.value=!0;try{const t=yield e.frm.amend();f.value=t,o.value="Amend successful!",m.value=!0,L.push({path:"/showform",query:{docname:t}})}catch(t){o.value=`Error: ${t.message}`,m.value=!1,console.error(`Error: ${t.message}`)}finally{r.value=!1,setTimeout(()=>{o.value=""},2500)}}),X=()=>w(this,null,function*(){r.value=!0;try{d.value=yield e.frm.submit(f.value),o.value="Submit successful!",m.value=!0,d.value=1,k.value=!1}catch(t){o.value=`Error: ${t.message}`,m.value=!1,console.error(`Error: ${t.message}`),k.value=!1}finally{r.value=!1,setTimeout(()=>{o.value=""},2500)}}),Y=()=>w(this,null,function*(){A.value=!1;try{yield e.frm.cancel(f.value),z.value="Cancel successful!",j.value=!0}catch(t){z.value=`Error: ${t.message}`,j.value=!1,console.error(`Error: ${t.message}`)}finally{r.value=!1,setTimeout(()=>{z.value=""},2500)}}),Z=()=>{k.value=!0},ee=()=>{T.value=!0},te=()=>{A.value=!0},le=y(()=>{const t=[];let v=0;for(const i of e.frm.fields)i.fieldtype==="Section Break"?(v+=1,t.push(i)):v===0&&t.push(i);return t}),se=y(()=>e.frm.style=="Success"?"bg-green-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Danger"?"bg-red-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Inverse"?"bg-black h-[2rem] rounded-2xl text-center":e.frm.style=="Warning"?"bg-orange-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Info"?"bg-blue-200 h-[2rem] rounded-2xl text-center":e.frm.style=="Primary"?"bg-[#9fa8da] h-[2rem] rounded-2xl text-center":"bg-gray-200 h-[2rem] rounded-2xl text-center"),ae=y(()=>e.frm.style=="Success"?"p-2 text-sm w-20 text-green-500":e.frm.style=="Danger"?"p-2 text-sm w-20 text-red-500":e.frm.style=="Inverse"?"p-2 text-sm w-20 text-white":e.frm.style=="Warning"?"p-2 text-sm w-20 text-orange-500":e.frm.style=="Info"?"p-2 text-sm w-20 text-blue-500":e.frm.style=="Primary"?"p-2 text-sm w-20 text-[#1a237e]":"p-2 text-sm w-20 text-gray-500"),re=y(()=>{if(e.frm.submitable==0)return"";if(e.frm.Saved===0)return"Not Saved";if(e.frm.Saved===1)return e.frm.submitable===1&&e.frm.Submit!==1?"Draft":e.frm.Docstatus===2?"Cancelled":e.frm.Submit===1?"Submitted":"Saved"}),ne=y(()=>{if(e.frm.submitable==0)return"";if(e.frm.Saved===0)return"bg-red-200 h-[2rem] rounded-2xl text-center";if(e.frm.Saved===1)return e.frm.submitable===1&&e.frm.Submit!==1?"bg-red-200 h-[2rem] rounded-2xl text-center":e.frm.Docstatus===2?"bg-red-200 rounded-2xl text-center":(e.frm.Submit===1,"bg-blue-200 h-[2rem] rounded-2xl text-center")}),oe=y(()=>{if(e.frm.submitable==0)return"";if(e.frm.Saved===0)return"p-2 text-sm w-20 text-red-500";if(e.frm.Saved===1)return e.frm.submitable===1&&e.frm.Submit!==1||e.frm.Docstatus===2?"p-2 text-sm w-20 text-red-500":(e.frm.Submit===1,"p-2 text-sm w-20 text-blue-500")}),E=n(""),ie=()=>w(this,null,function*(){f.value&&(E.value=yield e.frm.delete(f.value),setTimeout(()=>{E.value=""},2500),T.value=!1,U())}),ue=y(()=>{const t=[{label:"Print",icon:()=>I(b,{name:"printer"})},{label:"Create New "+e.frm.doctype,icon:()=>I(b,{name:"file-plus"}),onClick:()=>{me()}},{label:"Reload",icon:()=>I(b,{name:"refresh-ccw"}),onClick:()=>{window.location.reload()}}];return e.frm.Docstatus!==1&&t.push({label:"Delete",icon:()=>I(b,{name:"trash"}),onClick:ee}),[{group:"Actions",items:t}]}),L=De(),U=()=>{e.frm.doc={docstatus:0},e.frm.name=null,e.frm.fields=[],e.frm.Docstatus=0,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0,L.push({name:"ListPage",query:{frmname:e.frm.Frm,doctype:e.frm.doctype}})},me=()=>{e.frm.doc={docstatus:0},e.frm.name=null,e.frm.fields=[],e.frm.Docstatus=0,e.frm.Saved=0,e.frm.Submit=0,e.frm.Amend=0,L.push({name:"Form",query:{frmname:e.frm.Frm,doctype:e.frm.doctype}})};return(t,v)=>(s(),u("div",qe,[l("div",Fe,[l("div",Ue,[l("div",Re,[c(a(b),{class:"w-8 h-8 text-gray-600 hover:text-black",name:"chevron-left",onClick:U}),l("div",{class:h({"flex-1 text-center":!f.value})},[l("p",Pe,g(p.frm.doctype),1),f.value?(s(),u("p",Me,g(f.value),1)):C("",!0)],2),e.frm.workflowStatus?(s(),u("div",He,[l("div",{class:h(se.value)},[l("p",{class:h(ae.value)},g(e.frm.workflow_state),3)],2)])):(s(),u("div",Oe,[l("div",{class:h(ne.value)},[l("p",{class:h(oe.value)},g(re.value),3)],2)])),l("div",We,[l("div",Ge,[c(a(b),{class:"w-6 h-6 text-gray-600 hover:text-black",name:"bell"})]),c(Be)])])]),l("div",Je,[l("div",Ke,[(s(!0),u($e,null,Te(le.value,i=>(s(),_(Ae(x[i.fieldtype]),{key:i.fieldname,para:"",should:"",align:"",perfectly:"",field:i,frm:p.frm},null,8,["field","frm"]))),128))])]),c(ze,{name:"slide-up"},{default:N(()=>[S.value?(s(),u("div",Qe,[l("div",null,[l("div",{class:"w-full border-b-[0.5px] border-gray-300 flex text-center justify-center touchable hover:cursor-pointer",onClick:J},[l("p",Xe,g(e.frm.action),1)]),Ye])])):C("",!0)]),_:1}),S.value?(s(),u("div",{key:0,class:"fixed inset-0 bg-black opacity-50 z-[999] w-full sm:w-96",onClick:v[0]||(v[0]=i=>S.value=!1)})):C("",!0),l("div",Ze,[c(a(q),{options:{title:"Confirm",message:"Are you sure you want to submit this form "+e.docname+"?",size:"sm",actions:[{label:"Confirm",variant:"solid",onClick:X},{label:"Cancel",variant:"subtle",onClick:()=>{k.value=!1}}]},modelValue:k.value,"onUpdate:modelValue":v[1]||(v[1]=i=>k.value=i)},null,8,["options","modelValue"]),c(a(q),{options:{title:"Confirm Delete",message:"Are you sure you want to delete this form "+e.docname+"?",size:"sm",actions:[{label:"Delete",variant:"solid",onClick:ie},{label:"Cancel",variant:"subtle",onClick:()=>{T.value=!1}}]},modelValue:T.value,"onUpdate:modelValue":v[2]||(v[2]=i=>T.value=i)},null,8,["options","modelValue"]),c(a(q),{options:{title:"Confirm Cancel",message:"Are you sure you want to cancel this form "+e.docname+"?",size:"sm",actions:[{label:"Confirm",variant:"solid",onClick:Y},{label:"Cancel",variant:"subtle",onClick:()=>{A.value=!1}}]},modelValue:A.value,"onUpdate:modelValue":v[3]||(v[3]=i=>A.value=i)},null,8,["options","modelValue"]),l("div",et,[e.frm.workflowStatus?(s(),u("div",tt,[c(a(D),{variant:"solid",theme:"gray",size:"sm",label:"Action",loading:r.value,loadingText:"Saving...",disabled:B.value,link:null,class:"w-full h-full p-2",onClick:G},null,8,["loading","disabled"])])):(s(),u("div",lt,[e.frm.Saved==0||e.frm.submitable==0?(s(),_(a(D),{key:0,variant:"solid",theme:"gray",size:"sm",label:"Save",loading:r.value,loadingText:"Saving...",disabled:e.frm.saved,link:null,class:"w-full h-full p-2",onClick:K},null,8,["loading","disabled"])):e.frm.Docstatus===1&&e.frm.Saved==1&&e.frm.submitable==1?(s(),_(a(D),{key:1,variant:"solid",theme:"red",size:"sm",label:"Cancel",loading:r.value,loadingText:"Cancelling...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:te},null,8,["loading"])):e.frm.Docstatus==2&&e.frm.submitable==1?(s(),_(a(D),{key:2,variant:"solid",theme:"gray",size:"sm",label:"Amend",loading:r.value,loadingText:"Amending...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:Q},null,8,["loading"])):(s(),_(a(D),{key:3,variant:"solid",theme:"gray",size:"sm",label:"Submit",loading:r.value,loadingText:"Submitting...",disabled:!1,link:null,class:"w-full h-full p-2",onClick:Z},null,8,["loading"]))])),o.value?(s(),u("div",{key:2,class:h(["fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96",m.value?"animate-slide-in":"animate-slide-out"])},[l("div",{class:h(["rounded w-[20rem] h-fit p-2 text-left",{"bg-blue-200 text-blue-500":m.value,"bg-red-200 text-red-500":!m.value}])},[m.value?(s(),_(a(b),{key:0,name:"check",class:"inline w-4 h-4 mr-2"})):(s(),_(a(b),{key:1,name:"x",class:"inline w-4 h-4 mr-2"})),F(" "+g(o.value),1)],2)],2)):C("",!0),E.value?(s(),u("div",st,[l("div",at,[c(a(b),{name:"info",class:"inline w-4 h-4 mr-2"}),F(" "+g(E.value),1)])])):C("",!0),z.value?(s(),u("div",{key:4,class:h(["fixed bottom-[4rem] leading-5 pr-[65rem] pl-[2.5rem] z-50 w-full sm:w-96",j.value?"animate-slide-in":"animate-slide-out"])},[l("div",rt,[c(a(b),{name:"x",class:"inline w-4 h-4 mr-2"}),F(" "+g(z.value),1)])],2)):C("",!0)]),l("div",nt,[c(a(Le),{options:ue.value},{default:N(()=>[c(a(D),null,{icon:N(()=>[c(a(b),{name:"more-vertical",class:"h-6 w-6 text-gray-600 hover:text-black"})]),_:1})]),_:1},8,["options"])])])])]))}},it=Se(ot,[["__scopeId","data-v-36e0a400"]]),ut={class:"w-full flex-1 overflow-y-auto custom-scrollbar"},mt={key:1},gt={__name:"ShowForm",setup(p){const e=ke(),x=y(()=>e.form),r=je();return Ie(()=>w(this,null,function*(){yield e.initForm()})),(o,m)=>(s(),u("div",ut,[x.value?(s(),_(it,{key:0,docname:a(r).query.docname,frm:x.value,doctype:a(r).query.doctype,frmname:a(r).query.frmname},null,8,["docname","frm","doctype","frmname"])):(s(),u("p",mt,"Loading..."))]))}};export{gt as default};
