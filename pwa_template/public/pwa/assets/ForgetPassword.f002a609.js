import{r as a,i as x,o as f,a as _,b as e,d as r,w as d,u as v,_ as V,k as F,l as y,e as b,m as T,t as U,T as $,F as C,f as E}from"./index.4c13865c.js";const N={class:"w-full sm:w-96 bg-[#f4f5f7] flex justify-center items-center h-screen"},R={class:"w-full h-96 flex justify-center items-center"},q={class:"w-full object-center justify-center flex"},B=["src"],G=e("div",{class:"w-full"},[e("p",{class:"font-medium p-2 flex justify-center"},"Forget Password")],-1),H={class:"bg-white rounded-lg w-80 h-68 mt-4"},O={class:"p-4"},A={key:0,class:"text-red-500 text-xs pl-2"},D={class:"p-2"},M={class:"w-full"},J={class:"fixed bottom-0 flex justify-end w-full sm:w-96 pr-3"},Y={key:0,class:"w-full sm:w-72 p-2 mb-4 text-sm leading-5 text-white bg-blue-500 rounded-lg opacity-100 font-regular animate-slide-in-right animate-fade-out"},K={__name:"ForgetPassword",setup(z){const h=a(""),c=a(""),l=a(""),p=a(!1),i=a(!1),w=x(()=>!!c.value),k=a(window.location.href),u=x(()=>{const t=new URL(k.value);return`${t.protocol}//${t.hostname}`});u.value=u.value+":8001/assets";const j=a(`${u.value}:8001/assets`),P=a(`${u.value}:8001/`),L=()=>{const t=new Headers;t.append("Cookie","full_name=Guest; sid=Guest; system_user=no; user_id=Guest; user_image=");const n={method:"GET",headers:t,redirect:"follow"};fetch(j.value,n).then(s=>s.text()).then(s=>{const g=new DOMParser().parseFromString(s,"text/html").querySelector('link[rel="shortcut icon"]');g&&(h.value=g.href)}).catch(s=>console.error(s))},S=()=>{if(p.value=!0,!w.value)return;i.value=!0;const t=new Headers;t.append("Content-Type","application/json");const n=JSON.stringify({cmd:"frappe.core.doctype.user.user.reset_password",user:c.value}),s={method:"POST",headers:t,body:n,redirect:"follow"};fetch(P.value,s).then(o=>{o.text().then(m=>{i.value=!1,o.status===200?(l.value="Password reset instructions have been sent to your email",console.log(m)):o.status===404?(l.value="User Mail Not Found",console.log(m)):o.status===501?l.value="Please setup default Email Account from Settings > Email Account":l.value="You hit the rate limit because of too many requests. Please try after sometime.",setTimeout(()=>{l.value=""},1e3)})}).catch(o=>{i.value=!1,console.error(o)})};return L(),(t,n)=>{const s=E("router-link");return f(),_(C,null,[e("div",N,[e("div",R,[e("div",null,[e("div",q,[e("img",{src:h.value,class:"w-16 h-16 object-cover rounded-lg"},null,8,B)]),G,e("div",H,[e("div",O,[r(v(F),{required:"",type:"text",label:"Email",name:"email",modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=o=>c.value=o),placeholder:"johndoe@email.com",class:"p-2"},{prefix:d(()=>[r(v(V),{class:"w-4",name:"mail"})]),_:1},8,["modelValue"]),p.value&&!w.value?(f(),_("div",A,"Enter email !")):y("",!0),e("div",D,[r(v(T),{loading:i.value,variant:"solid",class:"w-full",onClick:S},{default:d(()=>[b(" Reset Password ")]),_:1},8,["loading"])]),e("div",M,[r(s,{to:"/",class:"text-sm font-medium text-black justify-center flex p-2 hover:underline"},{default:d(()=>[b("Back to Login")]),_:1})])])])])])]),e("div",J,[r($,{name:"fade"},{default:d(()=>[l.value?(f(),_("div",Y,U(l.value),1)):y("",!0)]),_:1})])],64)}}};export{K as default};
